function ImageUpload(e,t){function i(e){var t=e.name,i=0,n=e.files.length,a=new FormData;n>1&&(t+="[]"),this.append=function(e){a.append(t,e,e.name),++i},this.full=function(){return i===n},this.get=function(){return a}}function n(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]}function a(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var i=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return new Blob([n],{type:i})}function r(e){return"number"==typeof f.maxFileSize&&e.size>f.maxFileSize?(g="The file "+e.name+" must be less than "+f.maxFileSize/1024/1024+"MB",!1):f.fileTypes&&!f.fileTypes.test(e.type)?(g="Sorry, "+e.name+" is invalid, allowed extensions",!1):!0}function s(t){o.append(t),o.full()&&(xhr=new XMLHttpRequest,xhr.open("POST",e.action,!0),xhr.onload=function(e){200==this.status&&alert(this.responseText)},xhr.send(o.get()))}function l(e){var t=new Image,i=new FileReader;t.onload=function(){if(0==t.width||0==t.height)return!1;var i=t.width,n=t.height,r=!1,l=e;if(i>n?i>f.imageMaxWidth&&(n*=f.imageMaxWidth/i,i=f.imageMaxWidth,r=!0):n>f.imageMaxHeight&&(i*=f.imageMaxHeight/n,n=f.imageMaxHeight,r=!0),r){var o=document.createElement("canvas");o.width=i,o.height=n;var u=o.getContext("2d");u.drawImage(t,0,0,i,n);var g=o.toDataURL(e.type),l=a(g);l.lastModifiedDate=e.lastModifiedDate,l.name=e.name}s(l)},i.onload=function(e){t.src=e.target.result},i.readAsDataURL(e)}if(!("FormData"in window&&"FileReader"in window&&"Blob"in window&&"XMLHttpRequest"in window&&"Image"in window))return alert("Not support features"),!1;var o,u={fileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,maxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,disableImageResize:!1},g="",f=n({},u,t);e.onsubmit=function(){for(var t=e.querySelectorAll("input[type='file']"),n=0;n<t.length;n++){o=new i(t[n]);for(var a=0;a<t[n].files.length;a++){var u=t[n].files[a];if(!r(u))return alert(g),t[n].value="",!1;f.disableImageResize?s(u):l(u)}}return!1}}